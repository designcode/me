---
import BaseLayout from '../layouts/BaseLayout.astro';

const postFiles = import.meta.glob('./posts/*.mdx', { eager: true });
const posts = Object.entries(postFiles).map(([path, post]: [string, any]) => ({
  url: path.replace('./posts/', '/posts/').replace('.mdx', ''),
  frontmatter: post.frontmatter
})).sort(
  (a, b) => new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf()
);
---

<BaseLayout title="designcode.me" description="Thoughts and Ramblings">
  <div class="posts-list">
    {posts.map(post => {
      const isExternal = !!post.frontmatter.externalUrl;
      const linkUrl = isExternal ? post.frontmatter.externalUrl : post.url;
      const linkProps = isExternal ? { target: '_blank', rel: 'noopener noreferrer' } : {};

      return (
        <article class="post-item">
          <h2 class="post-title">
            <a href={linkUrl} class="post-link" {...linkProps}>
              {post.frontmatter.title}
              {isExternal && ' â†’'}
            </a>
          </h2>
          <p class="post-date">
            {new Date(post.frontmatter.date).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </p>
          <p class="post-description">
            {post.frontmatter.description}
          </p>
        </article>
      );
    })}
  </div>
</BaseLayout>
