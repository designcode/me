---
import BaseLayout from '../layouts/BaseLayout.astro';

const postFiles = import.meta.glob('./posts/*.mdx', { eager: true });
const posts = Object.entries(postFiles).map(([path, post]: [string, any]) => ({
  url: path.replace('./posts/', '/posts/').replace('.mdx', ''),
  frontmatter: post.frontmatter
})).sort(
  (a, b) => new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf()
);
---

<BaseLayout title="designcode.me" description="Thoughts and Ramblings">
  <div style="display: flex; flex-direction: column; gap: 2rem;">
    {posts.map(post => {
      const isExternal = !!post.frontmatter.externalUrl;
      const linkUrl = isExternal ? post.frontmatter.externalUrl : post.url;
      const linkProps = isExternal ? { target: '_blank', rel: 'noopener noreferrer' } : {};

      return (
        <article>
          <h2 style="margin-bottom: 0.5rem;">
            <a href={linkUrl} style="text-decoration: none;" {...linkProps}>
              {post.frontmatter.title}
              {isExternal && ' â†’'}
            </a>
          </h2>
          <p style="color: var(--color-secondary); font-size: 0.9rem; margin-bottom: 0.75rem;">
            {new Date(post.frontmatter.date).toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </p>
          <p style="margin-bottom: 0;">
            {post.frontmatter.description}
          </p>
        </article>
      );
    })}
  </div>
</BaseLayout>
