---
import BaseLayout from "./BaseLayout.astro";
import EmbedYoutube from "../components/EmbedYoutube.astro";
import EmbedStrava from "../components/EmbedStrava.astro";
import EmbedInstagram from "../components/EmbedInstagram.astro";
import EmbedAllTrails from "../components/EmbedAllTrails.astro";

interface Props {
  frontmatter: {
    title: string;
    date: string;
    description?: string;
    externalUrl?: string;
    category?: string;
    embedType?: "youtube" | "strava" | "instagram" | "alltrails";
    embedId?: string;
  };
}

const { frontmatter } = Astro.props;
---

<BaseLayout title={frontmatter.title} description={frontmatter.description}>
  <article>
    <header class="mb-12">
      <h1 class="text-4xl font-semibold leading-tight mb-3 text-primary mt-0">
        {frontmatter.title}
      </h1>
      <div class="flex items-center gap-3">
        <time class="text-secondary text-sm">
          {
            new Date(frontmatter.date).toLocaleDateString("en-US", {
              year: "numeric",
              month: "long",
              day: "numeric",
            })
          }
        </time>
        {
          frontmatter.category && (
            <span class="post-category">{frontmatter.category}</span>
          )
        }
      </div>
    </header>
    {
      frontmatter.embedType && frontmatter.embedId && (
        <div class="embed-wrapper mb-12">
          {frontmatter.embedType === "youtube" && (
            <EmbedYoutube
              videoId={frontmatter.embedId}
              title={frontmatter.title}
            />
          )}
          {frontmatter.embedType === "strava" && (
            <EmbedStrava activityId={frontmatter.embedId} />
          )}
          {frontmatter.embedType === "instagram" && (
            <EmbedInstagram postId={frontmatter.embedId} />
          )}
          {frontmatter.embedType === "alltrails" && (
            <EmbedAllTrails
              url={frontmatter.embedId}
              title={frontmatter.title}
            />
          )}
        </div>
      )
    }
    <div class="mb-12">
      <slot />
    </div>
    <a
      href="/"
      class="inline-block mt-8 text-foreground hover:text-primary transition-colors no-underline"
      >‚Üê Back to all posts</a
    >
  </article>
</BaseLayout>
